{
  "$schema": "http://json-schema.org/draft-07/schema#",
  "title": "Legal document attributes",
  "description": "Legal document attributes. Schema draft 4 is used for compatibility with Mongo DB",
  "definitions": {
    "tag": {
      "description": "a piece of text, denoting attributes",
      "type": "object",
      "properties": {
        "span": {
          "type": "array",
          "minItems": 2,
          "maxItems": 2
        },
        "confidence": {
          "type": "number"
        },
        "span_map": {
          "type": "string"
        },
        "changed": {
          "type": "boolean"
        }
      },
      "required": ["span"]
    },
    "string_tag": {
      "allOf": [
        {
          "$ref": "#/definitions/tag"
        },
        {
          "properties": {
            "value": {
              "type": "string"
            }
          }
        }
      ]
    },
    "boolean_tag": {
      "allOf": [
        {
          "$ref": "#/definitions/tag"
        },
        {
          "properties": {
            "value": {
              "type": "boolean"
            }
          }
        }
      ]
    },
    "number_tag": {
      "allOf": [
        {
          "$ref": "#/definitions/tag"
        },
        {
          "properties": {
            "value": {
              "type": "number"
            }
          }
        }
      ]
    },
    "insideInformation": {
      "allOf": [
        {
          "$ref": "#/definitions/tag"
        },
        {
          "properties": {
            "value": {
              "enum": [
                "Bankruptcy",
                "SharesOfParticipation",
                "SEB",
                "Changes",
                "Licenses",
                "OSA",
                "Accounting",
                "Plans",
                "SD",
                "Deals",
                "Courts",
                "IssuedSecurities"
              ]
            }
          }
        }
      ]
    },
    "date_tag": {
      "allOf": [
        {
          "$ref": "#/definitions/tag"
        },
        {
          "properties": {
            "value": {
              "type": "string",
              "format": "date-time"
            }
          }
        }
      ]
    },
    "agenda_contract": {
      "description": "\u0410\u0442\u0440\u0438\u0431\u0443\u0442\u044b \u043a\u043e\u043d\u0442\u0440\u0430\u043a\u0442\u0430, \u043e \u043a\u043e\u0442\u043e\u0440\u043e\u043c \u0438\u0434\u0435\u0442 \u0440\u0435\u0447\u044c \u0432 \u043f\u043e\u0432\u0435\u0441\u0442\u043a\u0435",
      "properties": {
        "number": {
          "$ref": "#/definitions/string_tag"
        },
        "date": {
          "$ref": "#/definitions/date_tag"
        },
        "solution": {
          "description": "\u0420\u0435\u0448\u0435\u043d\u0438\u0435, \u043f\u0440\u0438\u043d\u044f\u0442\u043e\u0435 \u043e\u0442\u043d\u043e\u0441\u0438\u0442\u0435\u043b\u044c\u043d\u043e \u0432\u043e\u043f\u0440\u043e\u0441\u0430 \u043f\u043e\u0432\u0435\u0441\u0442\u043a\u0438 \u0434\u043d\u044f",
          "$ref": "#/definitions/boolean_tag"
        },
        "orgs": {
          "type": "array",
          "items": {
            "$ref": "#/definitions/contract_agent"
          }
        },
        "value": {
          "$ref": "#/definitions/currency_value"
        }
      },
      "additionalProperties": false
    },
    "agenda": {
      "allOf": [
        {
          "$ref": "#/definitions/tag"
        },
        {
          "properties": {
            "contract": {
              "$ref": "#/definitions/agenda_contract"
            }
          },
          "required": ["span"]
        }
      ]
    },
    "currency": {
      "allOf": [
        {
          "$ref": "#/definitions/tag"
        },
        {
          "properties": {
            "value": {
              "enum": [
                "RUB",
                "USD",
                "EURO",
                "KZT",
                "BYN",
                "TJR",
                "RSD",
                "KGS",
                "UAH",
                "Percent",
                "%"
              ]
            }
          }
        }
      ]
    },
    "sign": {
      "allOf": [
        {
          "$ref": "#/definitions/tag"
        },
        {
          "properties": {
            "value": {
              "type": "integer",
              "enum": [-1, 0, 1]
            }
          }
        }
      ]
    },
    "person": {
      "allOf": [
        {
          "$ref": "#/definitions/tag"
        },
        {
          "properties": {
            "lastName": {
              "$ref": "#/definitions/string_tag"
            }
          },
          "required": ["lastName"],
          "errorMessage": {
            "required": {
              "lastName": "Не размечена фамилия!"
            }
          }
        }
      ]
    },
    "currency_value": {
      "allOf": [
        {
          "$ref": "#/definitions/tag"
        },
        {
          "properties": {
            "amount": {
              "$ref": "#/definitions/number_tag"
            },
            "currency": {
              "$ref": "#/definitions/currency"
            },
            "sign": {
              "$ref": "#/definitions/sign"
            }
          },
          "required": ["amount", "currency"],
          "errorMessage": {
            "required": {
              "amount": "Не размечена сумма!",
              "currency": "Не размечена единица измерения!"
            }
          }
        }
      ]
    },
    "subject": {
      "allOf": [
        {
          "$ref": "#/definitions/tag"
        },
        {
          "properties": {
            "value": {
              "enum": [
                "Other",
                "Charity",
                "RealEstate",
                "Loans",
                "Lawsuit",
                "Insurance",
                "Consulting",
                "RentingOut",
                "Renting",
                "BigDeal",
                "Deal",
                "AgencyContract",
                "BankGuarantees",
                "RelatedTransactions",
                "GeneralContract",
                "EmployeeContracts",
                "PledgeEncumbrance",
                "Liquidation",
                "Service",
                "CashPayments",
                "RefusalToLeaseLand",
                "DealGeneralBusiness",
                "RevisionCommission",
                "Reorganization",
                "InterestedPartyTransaction",
                "RelatedPartyTransaction",
                "AssetTransactions",
                "DealIntellectualProperty",
                "RealEstateTransactions",
                "SecuritiesTransactions",
                "RegisteredCapital",
                "ParticipationInOtherOrganizations",
                "DecisionsForSubsidiary"
              ]
            },
            "price": {
              "$ref": "#/definitions/currency_value"
            },
            "insideInformation": {
              "$ref": "#/definitions/insideInformation"
            }
          }
        }
      ]
    },
    "competence": {
      "allOf": [
        {
          "$ref": "#/definitions/tag"
        },
        {
          "properties": {
            "value": {
              "enum": [
                "Other",
                "Charity",
                "RealEstate",
                "Loans",
                "Lawsuit",
                "Insurance",
                "Consulting",
                "RentingOut",
                "Renting",
                "BigDeal",
                "Deal",
                "AgencyContract",
                "BankGuarantees",
                "RelatedTransactions",
                "GeneralContract",
                "EmployeeContracts",
                "PledgeEncumbrance",
                "Liquidation",
                "Service",
                "CashPayments",
                "RefusalToLeaseLand",
                "DealGeneralBusiness",
                "RevisionCommission",
                "Reorganization",
                "InterestedPartyTransaction",
                "RelatedPartyTransaction",
                "AssetTransactions",
                "DealIntellectualProperty",
                "RealEstateTransactions",
                "SecuritiesTransactions",
                "RegisteredCapital",
                "ParticipationInOtherOrganizations",
                "DecisionsForSubsidiary"
              ]
            },
            "constraints": {
              "type": "array",
              "items": {
                "$ref": "#/definitions/currency_value"
              }
            }
          }
        }
      ]
    },
    "structural_level": {
      "allOf": [
        {
          "$ref": "#/definitions/tag"
        },
        {
          "properties": {
            "value": {
              "enum": [
                "AllMembers",
                "ShareholdersGeneralMeeting",
                "BoardOfDirectors",
                "CEO",
                "BoardOfCompany"
              ]
            },
            "competences": {
              "type": "array",
              "items": {
                "$ref": "#/definitions/competence"
              }
            }
          }
        }
      ]
    },
    "org": {
      "type": "object",
      "properties": {
        "name": {
          "$ref": "#/definitions/string_tag"
        },
        "type": {
          "$ref": "#/definitions/string_tag"
        },
        "alias": {
          "$ref": "#/definitions/string_tag"
        },
        "alt_name": {
          "$ref": "#/definitions/string_tag"
        }
      }
    },
    "contract_agent": {
      "allOf": [
        {
          "$ref": "#/definitions/org"
        },
        {
          "properties": {
            "alias": {
              "$ref": "#/definitions/string_tag"
            }
          }
        }
      ]
    }
  },
  "properties": {
    "charter": {
      "properties": {
        "date": {
          "$ref": "#/definitions/date_tag"
        },
        "org": {
          "$ref": "#/definitions/org"
        },
        "structural_levels": {
          "type": "array",
          "uniqueItems": true,
          "items": {
            "$ref": "#/definitions/structural_level"
          }
        }
      }
    },
    "contract": {
      "properties": {
        "subject": {
          "$ref": "#/definitions/subject"
        },
        "date": {
          "$ref": "#/definitions/date_tag"
        },
        "number": {
          "$ref": "#/definitions/string_tag"
        },
        "price": {
          "$ref": "#/definitions/currency_value"
        },
        "insideInformation": {
          "$ref": "#/definitions/insideInformation"
        },
        "people": {
          "type": "array",
          "items": {
            "$ref": "#/definitions/person"
          }
        },
        "orgs": {
          "type": "array",
          "maxItems": 10,
          "uniqueItems": true,
          "items": {
            "$ref": "#/definitions/contract_agent"
          }
        }
      }
    },
    "protocol": {
      "properties": {
        "date": {
          "$ref": "#/definitions/date_tag"
        },
        "number": {
          "$ref": "#/definitions/number_tag"
        },
        "structural_level": {
          "$ref": "#/definitions/structural_level"
        },
        "orgs": {
          "type": "array",
          "maxItems": 1,
          "items": {
            "$ref": "#/definitions/org"
          }
        },
        "agenda_items": {
          "type": "array",
          "items": {
            "$ref": "#/definitions/agenda"
          }
        }
      }
    }
  }
}

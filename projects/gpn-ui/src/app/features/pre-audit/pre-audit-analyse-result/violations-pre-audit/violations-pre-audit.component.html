<table mat-table [dataSource]="dataSource" matSort  multiTemplateDataRows matSortActive="document" matSortDirection="desc">

  <!-- filename -->
  <ng-container matColumnDef="filename">
    <th mat-header-cell *matHeaderCellDef>Имя файла</th>
    <td mat-cell *matCellDef="let row">{{row.document_filename}}</td>
  </ng-container>

  <!-- Контрагент -->
  <ng-container matColumnDef="org2">
    <th mat-header-cell *matHeaderCellDef mat-sort-header disableClear>Контрагент</th>
    <td mat-cell *matCellDef="let row">
      <span class="org-type">{{ row?.orgs[0]?.type?.value}}</span>
      <span class="org-name">{{ row?.orgs[0]?.name?.value || '⚠️ не обнаружен'}}</span>
      <span class="org-alias">{{row?.orgs[0]?.alias?.value }}</span>    </td>
  </ng-container>
  <tr mat-header-row *matHeaderRowDef="col"></tr>
  <tr mat-row *matRowDef="let row; columns: col;" class="element-row"></tr>
</table>


<mat-tree [dataSource]="treeDataSource" [treeControl]="treeControl">

  <mat-tree-node *matTreeNodeDef="let node" matTreeNodePadding>
    <gpn-violation-detail [documents]="node" style="width: 100%"></gpn-violation-detail>
  </mat-tree-node>
  <mat-tree-node *matTreeNodeDef="let node; when: hasChild" matTreeNodePadding>
    <div style="width: 100%">
      <div class="row">
        <div class="col">
          <ng-container>
            <button mat-icon-button matTreeNodeToggle [attr.aria-label]="'toggle ' + node.name">
              <fa-icon [icon]="faChevronDown" *ngIf="!treeControl.isExpanded(node)"></fa-icon>
              <fa-icon [icon]="faChevronUp" *ngIf="treeControl.isExpanded(node)"></fa-icon>
            </button>
            {{ node.name | translate }} {{ '(' + node.childCount + ')' }}
          </ng-container>
        </div>
      </div>
      <mat-divider></mat-divider>
    </div>
  </mat-tree-node>
</mat-tree>

<table mat-table [dataSource]="dataSource" matSort  multiTemplateDataRows matSortActive="document" matSortDirection="desc">

  <!-- Документ -->
  <ng-container matColumnDef="document">
    <th mat-header-cell *matHeaderCellDef mat-sort-header disableClear>Документ, имеющий нарушение</th>
    <td mat-cell *matCellDef="let row">
      <span class="doc_type">{{ row.document.type | translate }}</span>
      <span class="number"> №{{ row.document.number  }} от {{ row.document.date | date}}</span>
    </td>
  </ng-container>

  <!-- Учредительный док. -->
  <ng-container matColumnDef="founding_document">
    <th mat-header-cell *matHeaderCellDef mat-sort-header disableClear>Учредительный документ</th>
    <td mat-cell *matCellDef="let row">
      <div *ngIf="row.founding_document">
        <span class="doc_type">{{ row.founding_document.type | translate }}</span>
        <span class="number"> №{{ row.founding_document.number  }} от {{ row.founding_document.date | date}}</span>
      </div>
    </td>
  </ng-container>

  <!-- Пункт -->
  <ng-container matColumnDef="item">
    <th mat-header-cell *matHeaderCellDef mat-sort-header disableClear>Подпункт, пункт, статья</th>
    <td mat-cell *matCellDef="let row">
      <span>{{ row.violation_type | translate  }}</span>
    </td>
  </ng-container>

  <!-- Нарушение -->
  <ng-container matColumnDef="violation_type">
    <th mat-header-cell *matHeaderCellDef mat-sort-header disableClear>Нарушение</th>
    <td mat-cell *matCellDef="let row">
      <span>{{ row.violation_type | translate  }}</span>
    </td>
  </ng-container>

  <!-- Основание -->
  <ng-container matColumnDef="base">
    <th mat-header-cell *matHeaderCellDef mat-sort-header disableClear>Основание нарушения</th>
    <td mat-cell *matCellDef="let row">
      <div *ngIf="row.reference">
        <span class="doc_type">{{ row.reference.type | translate }}</span>
        <span class="number"> №{{ row.reference.number  }} от {{ row.reference.date | date}}</span>
      </div>
    </td>
  </ng-container>

  <ng-container matColumnDef="expandedDetail">
    <td mat-cell *matCellDef="let row" [attr.colspan]="col.length">
      <div class="element-detail" [@detailExpand]="'expanded'">
        <div *ngIf="row.document && row.document.attribute">
          <span class="attribute">Фрагмент нарушения</span>
          <span class="reference">
            {{ row.document.attribute | translate }}: {{ row.document.attributeValue }}
          </span>
        </div>
        <div *ngIf="row.reference && row.reference.attribute">
          <span class="attribute">Фрагмент основания</span>
          <span class="reference">
            {{row.reference.attribute | translate}}: {{ row.reference.attributeValue }}
          </span>
        </div>
      </div>
    </td>
  </ng-container>

  <tr mat-header-row *matHeaderRowDef="col"></tr>

  <tr mat-row *matRowDef="let row; columns: col;" class="element-row"></tr>
  <tr mat-row *matRowDef="let row; columns: ['expandedDetail'];" class="detail-row"></tr>

</table>
